<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>example</title>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const auth = new Auth({
        clientId: '<%= htmlWebpackPlugin.options.clientId %>',
        redirectUrl: 'http://localhost:8080/login',
        scope: ['https://www.googleapis.com/auth/youtube.readonly']
      })

      auth.on("denied", msg => {
        alert(msg)
        document.body.innerHTML = `<button id="login">login</button>`
        addListener()
      })
      auth.on("login", token => {
        document.body.textContent = `login. token = ${token}`
        const youtubeApi = new YoutubeApi(auth)
        youtubeApi.channels.list({
          part: "snippet",
          mine: true
        })
        .then(response => response.json())
        .then(json => {
          document.body.textContent = `login. token = ${token}
          ${json.toString()}
          `
        })
      })
      auth.init()

      const addListener = () => {
        login.addEventListener("click", () => {
          auth.getToken()
        })
      }
      addListener()
    })
  </script>
</head>

<body>

  <button id="login">login</button>
</body>

</html>